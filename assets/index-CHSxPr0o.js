import{r as x,j as e,D as we,a as Me,b as Ce,T as K,F as $,I as z,S as ee,M as S,c as Pe,d as E,C as J,R as Ie,e as U,f as Le,B as L,g as te,h as Oe,P as Te,A as De,i as Ee,k as V,l as Fe,L as A,m as Ne,n as R,o as Ae,p as Re,q as H,s as $e,t as ze,u as Z,v as Y,w as Q,x as ne,y as Be,z as We,E as Je,G as Ue}from"./vendor-lHy64fqW.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const t of s)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function h(s){const t={};return s.integrity&&(t.integrity=s.integrity),s.referrerPolicy&&(t.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?t.credentials="include":s.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(s){if(s.ep)return;s.ep=!0;const t=h(s);fetch(s.href,t)}})();function Ve({location:n,onClose:r,onSave:h}){const[a,s]=x.useState({name:"",description:"",type:"",transportModes:{wheelchair:!1,electricVan:!1,walking:!1},gender:""}),[t,c]=x.useState(""),d=(i,u)=>{s(v=>({...v,[i]:u}))},p=i=>{s(u=>({...u,transportModes:{...u.transportModes,[i]:!u.transportModes[i]}}))},m=()=>{if(!a.name.trim()){c("ŸÜÿßŸÖ ⁄Øÿ±Ÿá ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ");return}const i=Object.keys(a.transportModes).filter(u=>a.transportModes[u]);h({...a,latitude:n.lat,longitude:n.lng,timestamp:new Date().toISOString(),transportModes:i}),r()};return e.jsxs(we,{open:!0,onClose:r,maxWidth:"sm",fullWidth:!0,children:[e.jsx(Me,{sx:{textAlign:"center",fontWeight:"bold"},children:"ÿß€åÿ¨ÿßÿØ ⁄Øÿ±Ÿá ÿ¨ÿØ€åÿØ"}),e.jsxs(Ce,{dividers:!0,children:[t&&e.jsx("div",{style:{color:"red",marginBottom:"16px",textAlign:"center"},children:t}),e.jsx(K,{label:"ŸÜÿßŸÖ ⁄Øÿ±Ÿá",fullWidth:!0,margin:"normal",value:a.name,onChange:i=>d("name",i.target.value),required:!0}),e.jsx(K,{label:"ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™",fullWidth:!0,margin:"normal",multiline:!0,rows:3,value:a.description,onChange:i=>d("description",i.target.value)}),e.jsxs($,{fullWidth:!0,margin:"normal",children:[e.jsx(z,{children:"ŸÜŸàÿπ ⁄Øÿ±Ÿá"}),e.jsxs(ee,{value:a.type,onChange:i=>d("type",i.target.value),label:"ŸÜŸàÿπ ⁄Øÿ±Ÿá",children:[e.jsx(S,{value:"checkpoint",children:"ŸÜŸÇÿ∑Ÿá ÿ®ÿßÿ≤ÿ±ÿ≥€å"}),e.jsx(S,{value:"landmark",children:"ŸÜÿ¥ÿßŸÜŸá"}),e.jsx(S,{value:"poi",children:"ŸÜŸÇÿ∑Ÿá ÿØŸÑÿÆŸàÿßŸá"}),e.jsx(S,{value:"other",children:"ÿ≥ÿß€åÿ±"})]})]}),e.jsxs($,{component:"fieldset",fullWidth:!0,margin:"normal",children:[e.jsx(z,{shrink:!0,children:"ÿ¥€åŸàŸá‚ÄåŸáÿß€å ÿ≠ŸÖŸÑ Ÿà ŸÜŸÇŸÑ"}),e.jsxs(Pe,{children:[e.jsx(E,{control:e.jsx(J,{checked:a.transportModes.wheelchair,onChange:()=>p("wheelchair")}),label:"Ÿà€åŸÑ⁄Üÿ±"}),e.jsx(E,{control:e.jsx(J,{checked:a.transportModes.electricVan,onChange:()=>p("electricVan")}),label:"ŸàŸÜ ÿ®ÿ±ŸÇ€å"}),e.jsx(E,{control:e.jsx(J,{checked:a.transportModes.walking,onChange:()=>p("walking")}),label:"Ÿæ€åÿßÿØŸá‚Äåÿ±Ÿà€å"})]})]}),e.jsxs($,{component:"fieldset",fullWidth:!0,margin:"normal",children:[e.jsx(z,{shrink:!0,children:"ÿ¨ŸÜÿ≥€åÿ™ ÿ™ÿ±ÿØÿØ"}),e.jsxs(Ie,{value:a.gender,onChange:i=>d("gender",i.target.value),children:[e.jsx(E,{value:"male",control:e.jsx(U,{}),label:"ŸÖÿ±ÿØÿßŸÜŸá"}),e.jsx(E,{value:"female",control:e.jsx(U,{}),label:"ÿ≤ŸÜÿßŸÜŸá"}),e.jsx(E,{value:"family",control:e.jsx(U,{}),label:"ÿÆÿßŸÜŸàÿßÿØ⁄Ø€å"})]})]})]}),e.jsxs(Le,{children:[e.jsx(L,{onClick:r,color:"secondary",children:"ÿßŸÜÿµÿ±ÿßŸÅ"}),e.jsx(L,{onClick:m,color:"primary",variant:"contained",children:"ÿ∞ÿÆ€åÿ±Ÿá"})]})]})}const He=()=>{const[n,r]=x.useState(()=>{const t=localStorage.getItem("mapMarkers");return t?JSON.parse(t):[]});return x.useEffect(()=>{localStorage.setItem("mapMarkers",JSON.stringify(n))},[n]),{markers:n,addMarker:t=>{r(c=>[...c,{...t,id:Date.now(),timestamp:new Date().toISOString()}])},removeMarker:t=>{r(c=>c.filter(d=>d.id!==t))},updateMarker:(t,c)=>{r(d=>d.map(p=>p.id===t?{...p,...c}:p))}}},_e=()=>{const[n,r]=x.useState(()=>{const t=localStorage.getItem("mapPaths");return t?JSON.parse(t):[]});return x.useEffect(()=>{localStorage.setItem("mapPaths",JSON.stringify(n))},[n]),{paths:n,addPath:t=>{r(c=>[...c,{...t,id:Date.now(),timestamp:new Date().toISOString()}])},removePath:t=>{r(c=>c.filter(d=>d.id!==t))},updatePath:(t,c)=>{r(d=>d.map(p=>p.id===t?{...p,...c}:p))}}},Ge=(n="geojson")=>{const r=JSON.parse(localStorage.getItem("mapMarkers")||"[]"),h=JSON.parse(localStorage.getItem("mapPaths")||"[]");let a,s,t;switch(n){case"geojson":const i={type:"FeatureCollection",features:[...r.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.position[1],l.position[0]]},properties:l.data||{}})),...h.map(l=>({type:"Feature",geometry:{type:"LineString",coordinates:l.coordinates.map(f=>[f[1],f[0]])},properties:{name:l.name,description:l.description,type:l.type,timestamp:l.timestamp}}))]};a=JSON.stringify(i,null,2),s="application/geo+json",t="geojson";break;case"kml":const u=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>`,v=`  </Document>
</kml>`,j=r.map(l=>{var f,C;return`
    <Placemark>
      <name>${((f=l.data)==null?void 0:f.name)||"Unnamed Marker"}</name>
      <description>${((C=l.data)==null?void 0:C.description)||""}</description>
      <Point>
        <coordinates>${l.position[1]},${l.position[0]},0</coordinates>
      </Point>
    </Placemark>`}).join(""),k=h.map(l=>`
    <Placemark>
      <name>${l.name||"Unnamed Path"}</name>
      <description>${l.description||""}</description>
      <LineString>
        <coordinates>
          ${l.coordinates.map(f=>`${f[1]},${f[0]},0`).join(" ")}
        </coordinates>
      </LineString>
    </Placemark>`).join("");a=u+j+k+v,s="application/vnd.google-earth.kml+xml",t="kml";break;case"csv":const b=`Type,Name,Description,Latitude,Longitude,Timestamp
`,F=r.map(l=>{var f,C;return`Point,"${((f=l.data)==null?void 0:f.name)||""}","${((C=l.data)==null?void 0:C.description)||""}",${l.position[0]},${l.position[1]},"${l.timestamp}"`}).join(`
`),I=h.map(l=>`Line,"${l.name||""}","${l.description||""}",${l.coordinates[0][0]},${l.coordinates[0][1]},"${l.timestamp}"`).join(`
`);a=b+F+(r.length&&h.length?`
`:"")+I,s="text/csv",t="csv";break;default:const O={version:"1.0",exportDate:new Date().toISOString(),markers:r,paths:h};a=JSON.stringify(O,null,2),s="application/json",t="json"}const c=new Blob([a],{type:s}),d=URL.createObjectURL(c),p=`map_export_${new Date().toISOString().replace(/[:.]/g,"-")}.${t}`,m=document.createElement("a");m.href=d,m.download=p,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(d)},qe=n=>new Promise((r,h)=>{const a=new FileReader;a.onload=s=>{try{const t=JSON.parse(s.target.result);t.version&&t.markers&&t.paths?(localStorage.setItem("mapMarkers",JSON.stringify(t.markers)),localStorage.setItem("mapPaths",JSON.stringify(t.paths)),r(t)):h(new Error("Invalid import file format"))}catch(t){h(t)}},a.onerror=s=>h(s),a.readAsText(n)});function Ke({isTracking:n,onStartTracking:r,onStopTracking:h,onAddMarker:a,onExport:s,onImportClick:t,onFilter:c}){const[d,p]=x.useState(null),m=u=>{p(u.currentTarget)},i=u=>{p(null),u&&typeof s=="function"&&s(u)};return e.jsxs(te,{sx:{position:"fixed",bottom:0,left:0,right:0,bgcolor:"background.paper",display:"flex",justifyContent:"center",padding:"8px",zIndex:1200,borderTop:"1px solid",borderColor:"divider",gap:1},children:[e.jsx(L,{onClick:n?h:r,startIcon:n?e.jsx(Oe,{}):e.jsx(Te,{}),variant:n?"contained":"outlined",color:n?"error":"success",size:"small",children:n?"ÿ™ŸàŸÇŸÅ":"ÿ±ÿØ€åÿßÿ®€å"}),e.jsx(L,{onClick:a,startIcon:e.jsx(De,{}),variant:"outlined",color:"primary",size:"small",children:"ŸÜÿ¥ÿßŸÜ⁄Øÿ±"}),e.jsx(L,{onClick:c,startIcon:e.jsx(Ee,{}),variant:"outlined",color:"secondary",size:"small",children:"ŸÅ€åŸÑÿ™ÿ±"}),e.jsx(L,{onClick:m,startIcon:e.jsx(V,{}),variant:"contained",color:"warning",size:"small",children:"ÿÆÿ±Ÿàÿ¨€å"}),e.jsxs(Fe,{anchorEl:d,open:!!d,onClose:()=>i(),children:[e.jsxs(S,{onClick:()=>i("geojson"),children:[e.jsx(A,{children:e.jsx(Ne,{fontSize:"small"})}),e.jsx(R,{children:"GeoJSON"})]}),e.jsxs(S,{onClick:()=>i("kml"),children:[e.jsx(A,{children:e.jsx(Ae,{fontSize:"small"})}),e.jsx(R,{children:"KML"})]}),e.jsxs(S,{onClick:()=>i("csv"),children:[e.jsx(A,{children:e.jsx(V,{fontSize:"small"})}),e.jsx(R,{children:"CSV"})]}),e.jsxs(S,{onClick:()=>i("json"),children:[e.jsx(A,{children:e.jsx(V,{fontSize:"small"})}),e.jsx(R,{children:"JSON"})]})]}),e.jsx(L,{onClick:t,startIcon:e.jsx(Re,{}),variant:"outlined",size:"small",sx:{ml:"auto"},children:"Ÿàÿ±ŸàÿØ€å"})]})}const X=H.divIcon({className:"custom-marker-icon",html:`
    <div style="
      width: 30px; 
      height: 30px; 
      background-color: #2196F3; 
      border-radius: 50%; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      color: white; 
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    ">
      üìç
    </div>
  `,iconSize:[30,30],iconAnchor:[15,15]}),Ze=({selectedItem:n,onDelete:r,onClose:h})=>{var t,c,d,p,m,i,u,v;const a=j=>!j||j.length===0?"ŸÜÿØÿßÿ±ÿØ":j.map(k=>{switch(k){case"wheelchair":return"Ÿà€åŸÑ⁄Üÿ±";case"electricVan":return"ŸàŸÜ ÿ®ÿ±ŸÇ€å";case"walking":return"Ÿæ€åÿßÿØŸá‚Äåÿ±Ÿà€å";default:return k}}).join(", "),s=j=>{if(!j||j.length<2)return 0;let k=0;for(let b=1;b<j.length;b++){const F=H.latLng(j[b-1][0],j[b-1][1]),I=H.latLng(j[b][0],j[b][1]);k+=F.distanceTo(I)}return(k/1e3).toFixed(2)};return e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 4px 15px rgba(0,0,0,0.2)",width:"90%",maxWidth:"400px",maxHeight:"80vh",overflowY:"auto",zIndex:1e3},children:[e.jsxs("h2",{style:{marginBottom:"15px",textAlign:"center",color:"#333"},children:["ÿ¨ÿ≤ÿ¶€åÿßÿ™ ",n.type==="marker"?"ŸÜÿ¥ÿßŸÜ⁄Øÿ±":"ŸÖÿ≥€åÿ±"]}),e.jsxs("div",{style:{backgroundColor:"#f4f4f4",padding:"15px",borderRadius:"8px",marginBottom:"15px"},children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ŸÜÿßŸÖ:"})," ",((t=n.item.data)==null?void 0:t.name)||n.item.name||"ÿ®ÿØŸàŸÜ ŸÜÿßŸÖ"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™:"})," ",((c=n.item.data)==null?void 0:c.description)||n.item.description||"ÿ®ÿØŸàŸÜ ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™"]})]}),n.type==="marker"&&e.jsxs("div",{style:{backgroundColor:"#e9f5e9",padding:"15px",borderRadius:"8px",marginBottom:"15px"},children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ŸÜŸàÿπ ŸÜÿ¥ÿßŸÜ⁄Øÿ±:"})," ",((d=n.item.data)==null?void 0:d.type)||"ŸÜÿßŸÖÿ¥ÿÆÿµ"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ¥€åŸàŸá‚ÄåŸáÿß€å ÿ≠ŸÖŸÑ Ÿà ŸÜŸÇŸÑ:"})," ",a((p=n.item.data)==null?void 0:p.transportModes)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ¨ŸÜÿ≥€åÿ™ ÿ™ÿ±ÿØÿØ:"}),((m=n.item.data)==null?void 0:m.gender)==="male"?"ŸÖÿ±ÿØÿßŸÜŸá":((i=n.item.data)==null?void 0:i.gender)==="female"?"ÿ≤ŸÜÿßŸÜŸá":((u=n.item.data)==null?void 0:u.gender)==="family"?"ÿÆÿßŸÜŸàÿßÿØ⁄Ø€å":"ŸÜÿßŸÖÿ¥ÿÆÿµ"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å:"}),`${n.item.position[0].toFixed(4)}, ${n.item.position[1].toFixed(4)}`]})]}),n.type==="path"&&e.jsxs("div",{style:{backgroundColor:"#e6f2ff",padding:"15px",borderRadius:"8px",marginBottom:"15px"},children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ŸÜŸàÿπ ŸÖÿ≥€åÿ±:"})," ",n.item.type||"ŸÜÿßŸÖÿ¥ÿÆÿµ"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ∑ŸàŸÑ ŸÖÿ≥€åÿ±:"})," ",s(n.item.coordinates)," ⁄©€åŸÑŸàŸÖÿ™ÿ±"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ™ÿπÿØÿßÿØ ŸÜŸÇÿßÿ∑ ŸÖÿ≥€åÿ±:"})," ",((v=n.item.coordinates)==null?void 0:v.length)||0]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ™ÿßÿ±€åÿÆ ÿß€åÿ¨ÿßÿØ:"})," ",new Date(n.item.timestamp).toLocaleDateString("fa-IR")]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"15px"},children:[e.jsxs("button",{onClick:r,style:{backgroundColor:"#dc3545",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{children:"üóëÔ∏è"})," ÿ®ŸÑŸáÿå ÿ≠ÿ∞ŸÅ ÿ¥ŸàÿØ"]}),e.jsxs("button",{onClick:h,style:{backgroundColor:"#6c757d",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{children:"‚úñ"})," ÿßŸÜÿµÿ±ÿßŸÅ"]})]})]})};function Ye({onSave:n,onClose:r,pathCoordinates:h}){const[a,s]=x.useState(""),[t,c]=x.useState(""),[d,p]=x.useState(""),m=()=>{if(!a.trim()){alert("ŸÜÿßŸÖ ŸÖÿ≥€åÿ± ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ");return}const i={name:a,description:t,type:d,coordinates:h,timestamp:new Date().toISOString()};n(i),r()};return e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",zIndex:1e3,width:"90%",maxWidth:"400px"},children:[e.jsx("h2",{children:"ÿ∞ÿÆ€åÿ±Ÿá‚Äåÿ≥ÿßÿ≤€å ŸÖÿ≥€åÿ±"}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("label",{children:"ŸÜÿßŸÖ ŸÖÿ≥€åÿ±:"}),e.jsx("input",{type:"text",value:a,onChange:i=>s(i.target.value),placeholder:"ŸÜÿßŸÖ ŸÖÿ≥€åÿ± ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ",style:{width:"100%",padding:"5px"},required:!0})]}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("label",{children:"ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™:"}),e.jsx("textarea",{value:t,onChange:i=>c(i.target.value),placeholder:"ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™ ŸÖÿ≥€åÿ± ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ",style:{width:"100%",padding:"5px",minHeight:"100px"}})]}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("label",{children:"ŸÜŸàÿπ ŸÖÿ≥€åÿ±:"}),e.jsxs("select",{value:d,onChange:i=>p(i.target.value),style:{width:"100%",padding:"5px"},children:[e.jsx("option",{value:"",children:"ÿßŸÜÿ™ÿÆÿßÿ® ŸÜŸàÿπ ŸÖÿ≥€åÿ±"}),e.jsx("option",{value:"hiking",children:"Ÿæ€åÿßÿØŸá‚Äåÿ±Ÿà€å"}),e.jsx("option",{value:"driving",children:"ÿ±ÿßŸÜŸÜÿØ⁄Ø€å"}),e.jsx("option",{value:"other",children:"ÿ≥ÿß€åÿ±"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("button",{onClick:m,style:{padding:"10px",backgroundColor:"green",color:"white",border:"none",borderRadius:"5px"},children:"ÿ∞ÿÆ€åÿ±Ÿá"}),e.jsx("button",{onClick:r,style:{padding:"10px",backgroundColor:"red",color:"white",border:"none",borderRadius:"5px"},children:"ÿßŸÜÿµÿ±ÿßŸÅ"})]})]})}function Qe({onMapClick:n}){return Je({click:r=>{n(r.latlng)}}),null}function Xe({position:n,zoom:r}){const h=We();return x.useEffect(()=>{n&&h.setView(n,r)},[n,r]),null}function et({isOpen:n,onClose:r,filterOptions:h,setFilterOptions:a}){if(!n)return null;const s=(t,c)=>{a(d=>{const p=d[t]||[],m=p.includes(c)?p.filter(i=>i!==c):[...p,c];return{...d,[t]:m}})};return e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 4px 15px rgba(0,0,0,0.2)",zIndex:1e3,width:"90%",maxWidth:"400px"},children:[e.jsx("h2",{children:"ŸÅ€åŸÑÿ™ÿ±ÿ≥ÿßÿ≤€å"}),e.jsxs("div",{children:[e.jsx("h3",{children:"ŸÜŸàÿπ ŸÜÿ¥ÿßŸÜ⁄Øÿ±"}),["checkpoint","landmark","poi","other"].map(t=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:h.markerTypes.includes(t),onChange:()=>s("markerTypes",t)}),t==="checkpoint"&&"ŸÜŸÇÿ∑Ÿá ÿ®ÿßÿ≤ÿ±ÿ≥€å",t==="landmark"&&"ŸÜÿ¥ÿßŸÜŸá",t==="poi"&&"ŸÜŸÇÿ∑Ÿá ÿØŸÑÿÆŸàÿßŸá",t==="other"&&"ÿ≥ÿß€åÿ±"]},t))]}),e.jsxs("div",{children:[e.jsx("h3",{children:"ŸÜŸàÿπ ŸÖÿ≥€åÿ±"}),["hiking","driving","other"].map(t=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:h.pathTypes.includes(t),onChange:()=>s("pathTypes",t)}),t==="hiking"&&"Ÿæ€åÿßÿØŸá‚Äåÿ±Ÿà€å",t==="driving"&&"ÿ±ÿßŸÜŸÜÿØ⁄Ø€å",t==="other"&&"ÿ≥ÿß€åÿ±"]},t))]}),e.jsx("button",{onClick:r,children:"ÿ®ÿ≥ÿ™ŸÜ"})]})}const tt=()=>{const[n,r]=x.useState([36.2972,59.6067]),[h,a]=x.useState(12),[s,t]=x.useState(null),[c,d]=x.useState(null),[p,m]=x.useState([]),[i,u]=x.useState(null),[v,j]=x.useState(null),[k,b]=x.useState(!1),[F,I]=x.useState(!1),[O,l]=x.useState(null),[f,C]=x.useState(!1),[_,oe]=x.useState("street"),se=(o="json")=>{Ge(o)},[w,re]=x.useState({markerTypes:[],pathTypes:[],transportModes:[],gender:[]}),ae={street:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",satellite:"https://tiles.maps.eox.at/wmts/1.0.0/s2cloudless-2020_3857/default/g/{z}/{y}/{x}.jpg"},{markers:ie,addMarker:le,removeMarker:ce}=He(),{paths:de,addPath:pe,removePath:he}=_e(),B=x.useRef(null),G=x.useCallback(()=>{if(u(null),!navigator.geolocation){u("ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å ÿØÿ± ÿØÿ≥ÿ™⁄ØÿßŸá ÿ¥ŸÖÿß Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ€å ŸÜŸÖ€å‚Äåÿ¥ŸàÿØ");return}const o={enableHighAccuracy:!0,timeout:3e4,maximumAge:0};navigator.geolocation.getCurrentPosition(g=>{const{latitude:y,longitude:T,accuracy:D}=g.coords,M=[y,T];t(M),d(D),r(M),a(15)},g=>{switch(g.code){case g.PERMISSION_DENIED:u("ÿØÿ≥ÿ™ÿ±ÿ≥€å ÿ®Ÿá ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å ÿ±ÿØ ÿ¥ÿØ");break;case g.POSITION_UNAVAILABLE:u("ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÖŸàŸÇÿπ€åÿ™ ÿØÿ± ÿØÿ≥ÿ™ÿ±ÿ≥ ŸÜ€åÿ≥ÿ™");break;case g.TIMEOUT:u("ÿ≤ŸÖÿßŸÜ ÿØÿ±ÿÆŸàÿßÿ≥ÿ™ ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å ÿ®Ÿá Ÿæÿß€åÿßŸÜ ÿ±ÿ≥€åÿØ");break;default:u("ÿÆÿ∑ÿß ÿØÿ± ÿØÿ±€åÿßŸÅÿ™ ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å")}r([36.2972,59.6067]),a(12)},o)},[]),ue=()=>{b(!0),m([]),u(null);const o=setTimeout(()=>{p.length===0&&(W(),u("ÿπÿØŸÖ ŸÖŸàŸÅŸÇ€åÿ™ ÿØÿ± ÿØÿ±€åÿßŸÅÿ™ ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å. ŸÑÿ∑ŸÅÿßŸã ŸÖÿ¨ÿØÿØÿßŸã ÿ™ŸÑÿßÿ¥ ⁄©ŸÜ€åÿØ."))},3e4);B.current=navigator.geolocation.watchPosition(g=>{const{latitude:y,longitude:T,accuracy:D}=g.coords,M=[y,T];clearTimeout(o),D<=500&&(t(M),u(null),m(P=>{if(P.length===0)return[M];const N=P[P.length-1],q=1e-5;return Math.abs(N[0]-y)>q||Math.abs(N[1]-T)>q?[...P,M]:P}))},g=>{console.error("Tracking error:",g),clearTimeout(o);let y="ÿÆÿ∑ÿß ÿØÿ± ÿØÿ±€åÿßŸÅÿ™ ŸÖŸàŸÇÿπ€åÿ™";switch(g.code){case g.PERMISSION_DENIED:y="ÿØÿ≥ÿ™ÿ±ÿ≥€å ÿ®Ÿá ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å ÿ±ÿØ ÿ¥ÿØ";break;case g.POSITION_UNAVAILABLE:y="ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÖŸàŸÇÿπ€åÿ™ ÿØÿ± ÿØÿ≥ÿ™ÿ±ÿ≥ ŸÜ€åÿ≥ÿ™";break;case g.TIMEOUT:y="ÿ≤ŸÖÿßŸÜ ÿØÿ±ÿÆŸàÿßÿ≥ÿ™ ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å ÿ®Ÿá Ÿæÿß€åÿßŸÜ ÿ±ÿ≥€åÿØ";break}u(y),W()},{enableHighAccuracy:!0,timeout:3e4,maximumAge:0,distanceFilter:1})},W=()=>{B.current&&(navigator.geolocation.clearWatch(B.current),b(!1),p.length>1?I(!0):(m([]),u("ŸÖÿ≥€åÿ± ÿ®ÿ≥€åÿßÿ± ⁄©Ÿàÿ™ÿßŸá ÿßÿ≥ÿ™. ŸÑÿ∑ŸÅÿßŸã ŸÖÿ≥ÿßŸÅÿ™ ÿ®€åÿ¥ÿ™ÿ±€å ÿ±ÿß ÿ∑€å ⁄©ŸÜ€åÿØ.")))},xe=o=>{l({type:"marker",item:o})},ge=o=>{l({type:"path",item:o})},me=()=>{if(O){const{type:o,item:g}=O;o==="marker"?ce(g.id):o==="path"&&he(g.id),l(null)}},je=o=>{pe(o),I(!1),m([])};x.useEffect(()=>{G()},[G]);const fe=o=>{j({lat:o.lat,lng:o.lng})},ye=o=>{le({position:[o.latitude,o.longitude],data:o}),j(null)},ke=o=>{const g=o.target.files[0];g&&qe(g).then(()=>{alert("ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ®ÿß ŸÖŸàŸÅŸÇ€åÿ™ Ÿàÿßÿ±ÿØ ÿ¥ÿØ!")}).catch(y=>{console.error("Import failed:",y),alert("Ÿàÿßÿ±ÿØÿ≥ÿßÿ≤€å ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÜÿßŸÖŸàŸÅŸÇ ÿ®ŸàÿØ")})},be=ie.filter(o=>{var D,M,P;const g=w.markerTypes.length===0||w.markerTypes.includes((D=o.data)==null?void 0:D.type),y=w.transportModes.length===0||((M=o.data)==null?void 0:M.transportModes)&&o.data.transportModes.some(N=>w.transportModes.includes(N)),T=w.gender.length===0||w.gender.includes((P=o.data)==null?void 0:P.gender);return g&&y&&T}),Se=de.filter(o=>w.pathTypes.length===0||w.pathTypes.includes(o.type)),ve=o=>{switch(o){case"hiking":return"#4CAF50";case"cycling":return"#2196F3";case"driving":return"#FF9800";default:return"#9C27B0"}};return e.jsxs("div",{className:"map-container",children:[e.jsx(te,{sx:{position:"absolute",top:"10px",right:"10px",backgroundColor:"#ffffffee",padding:"10px",borderRadius:"8px",zIndex:1200,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",direction:"rtl",minWidth:"180px"},children:e.jsxs($,{fullWidth:!0,variant:"outlined",size:"small",children:[e.jsx(z,{id:"map-layer-label",style:{right:"0px",fontWeight:"bold"},children:"ŸÜŸÇÿ¥Ÿá Ÿæÿß€åŸá"}),e.jsxs(ee,{labelId:"map-layer-label",id:"map-layer-select",value:_,label:"ŸÜŸÇÿ¥Ÿá Ÿæÿß€åŸá",onChange:o=>oe(o.target.value),children:[e.jsx(S,{value:"street",children:"Street View"}),e.jsx(S,{value:"satellite",children:"Satellite View"})]})]})}),F&&e.jsx(Ye,{onSave:je,onClose:()=>I(!1),pathCoordinates:p}),v&&e.jsx(Ve,{location:v,onClose:()=>j(null),onSave:ye}),f&&e.jsx(et,{isOpen:f,onClose:()=>C(!1),filterOptions:w,setFilterOptions:re}),O&&e.jsx(Ze,{selectedItem:O,onDelete:me,onClose:()=>l(null)}),e.jsxs($e,{center:n,zoom:h,scrollWheelZoom:!0,style:{width:"100%",height:"100%",position:"absolute",margin:0,padding:0,direction:"rtl"},children:[e.jsx(Xe,{position:n,zoom:h}),e.jsx(Qe,{onMapClick:fe}),e.jsx(ze,{url:ae[_],attribution:'¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),s&&c&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{center:s,radius:c,color:"blue",fillColor:"blue",fillOpacity:.1,weight:2}),e.jsx(Z,{center:s,radius:5,color:"blue",fillColor:"blue",fillOpacity:1,weight:0})]}),p.length>1&&e.jsx(Y,{positions:p,color:"blue",weight:5,opacity:k?.7:1,dashArray:k?"1, 1":null}),be.map(o=>e.jsx(Q,{position:o.position,icon:X,eventHandlers:{click:()=>xe(o)}},o.id)),Se.map(o=>!o.coordinates||!Array.isArray(o.coordinates)||o.coordinates.length===0?(console.warn("Path has invalid coordinates:",o),null):e.jsxs(ne.Fragment,{children:[e.jsx(Y,{positions:o.coordinates,color:ve(o.type),weight:5,opacity:.7}),e.jsx(Q,{position:o.coordinates[0],icon:X,eventHandlers:{click:()=>ge(o)},children:e.jsx(Be,{children:e.jsxs("div",{children:[e.jsx("strong",{children:o.name}),e.jsx("p",{children:o.description}),e.jsxs("p",{children:["ŸÜŸàÿπ ŸÖÿ≥€åÿ±: ",o.type]})]})})})]},o.id))]}),e.jsx(Ke,{isTracking:k,onStartTracking:ue,onStopTracking:W,onAddMarker:()=>j({lat:n[0],lng:n[1]}),onExport:se,onFilter:()=>C(!0)}),e.jsx("input",{id:"importInput",type:"file",accept:".json",onChange:ke,style:{display:"none"}})]})};Ue.createRoot(document.getElementById("root")).render(e.jsx(ne.StrictMode,{children:e.jsx(tt,{})}));
