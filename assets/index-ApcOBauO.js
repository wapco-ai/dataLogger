import{r as u,j as e,D as Me,a as Ce,b as Pe,T as K,F as B,I as W,S as ee,M as S,c as Ie,d as T,C as U,R as Le,e as V,f as Oe,B as L,g as te,h as Te,P as De,A as Ee,i as Fe,k as H,l as Ne,L as $,m as Re,n as z,o as Ae,p as $e,q as _,s as ze,t as Be,u as Z,v as Y,w as Q,x as ne,y as We,z as Je,E as Ue,G as Ve}from"./vendor-lHy64fqW.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const t of r)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function h(r){const t={};return r.integrity&&(t.integrity=r.integrity),r.referrerPolicy&&(t.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?t.credentials="include":r.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(r){if(r.ep)return;r.ep=!0;const t=h(r);fetch(r.href,t)}})();function He({location:o,onClose:s,onSave:h}){const[a,r]=u.useState({name:"",description:"",type:"",transportModes:{wheelchair:!1,electricVan:!1,walking:!1},gender:""}),[t,c]=u.useState(""),p=(i,x)=>{r(v=>({...v,[i]:x}))},d=i=>{r(x=>({...x,transportModes:{...x.transportModes,[i]:!x.transportModes[i]}}))},g=()=>{if(!a.name.trim()){c("ŸÜÿßŸÖ ⁄Øÿ±Ÿá ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ");return}const i=Object.keys(a.transportModes).filter(x=>a.transportModes[x]);h({...a,latitude:o.lat,longitude:o.lng,timestamp:new Date().toISOString(),transportModes:i}),s()};return e.jsxs(Me,{open:!0,onClose:s,maxWidth:"sm",fullWidth:!0,children:[e.jsx(Ce,{sx:{textAlign:"center",fontWeight:"bold"},children:"ÿß€åÿ¨ÿßÿØ ⁄Øÿ±Ÿá ÿ¨ÿØ€åÿØ"}),e.jsxs(Pe,{dividers:!0,children:[t&&e.jsx("div",{style:{color:"red",marginBottom:"16px",textAlign:"center"},children:t}),e.jsx(K,{label:"ŸÜÿßŸÖ ⁄Øÿ±Ÿá",fullWidth:!0,margin:"normal",value:a.name,onChange:i=>p("name",i.target.value),required:!0}),e.jsx(K,{label:"ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™",fullWidth:!0,margin:"normal",multiline:!0,rows:3,value:a.description,onChange:i=>p("description",i.target.value)}),e.jsxs(B,{fullWidth:!0,margin:"normal",children:[e.jsx(W,{children:"ŸÜŸàÿπ ⁄Øÿ±Ÿá"}),e.jsxs(ee,{value:a.type,onChange:i=>p("type",i.target.value),label:"ŸÜŸàÿπ ⁄Øÿ±Ÿá",children:[e.jsx(S,{value:"checkpoint",children:"ŸÜŸÇÿ∑Ÿá ÿ®ÿßÿ≤ÿ±ÿ≥€å"}),e.jsx(S,{value:"landmark",children:"ŸÜÿ¥ÿßŸÜŸá"}),e.jsx(S,{value:"poi",children:"ŸÜŸÇÿ∑Ÿá ÿØŸÑÿÆŸàÿßŸá"}),e.jsx(S,{value:"other",children:"ÿ≥ÿß€åÿ±"})]})]}),e.jsxs(B,{component:"fieldset",fullWidth:!0,margin:"normal",children:[e.jsx(W,{shrink:!0,children:"ÿ¥€åŸàŸá‚ÄåŸáÿß€å ÿ≠ŸÖŸÑ Ÿà ŸÜŸÇŸÑ"}),e.jsxs(Ie,{children:[e.jsx(T,{control:e.jsx(U,{checked:a.transportModes.wheelchair,onChange:()=>d("wheelchair")}),label:"Ÿà€åŸÑ⁄Üÿ±"}),e.jsx(T,{control:e.jsx(U,{checked:a.transportModes.electricVan,onChange:()=>d("electricVan")}),label:"ŸàŸÜ ÿ®ÿ±ŸÇ€å"}),e.jsx(T,{control:e.jsx(U,{checked:a.transportModes.walking,onChange:()=>d("walking")}),label:"Ÿæ€åÿßÿØŸá‚Äåÿ±Ÿà€å"})]})]}),e.jsxs(B,{component:"fieldset",fullWidth:!0,margin:"normal",children:[e.jsx(W,{shrink:!0,children:"ÿ¨ŸÜÿ≥€åÿ™ ÿ™ÿ±ÿØÿØ"}),e.jsxs(Le,{value:a.gender,onChange:i=>p("gender",i.target.value),children:[e.jsx(T,{value:"male",control:e.jsx(V,{}),label:"ŸÖÿ±ÿØÿßŸÜŸá"}),e.jsx(T,{value:"female",control:e.jsx(V,{}),label:"ÿ≤ŸÜÿßŸÜŸá"}),e.jsx(T,{value:"family",control:e.jsx(V,{}),label:"ÿÆÿßŸÜŸàÿßÿØ⁄Ø€å"})]})]})]}),e.jsxs(Oe,{children:[e.jsx(L,{onClick:s,color:"secondary",children:"ÿßŸÜÿµÿ±ÿßŸÅ"}),e.jsx(L,{onClick:g,color:"primary",variant:"contained",children:"ÿ∞ÿÆ€åÿ±Ÿá"})]})]})}const _e=()=>{const[o,s]=u.useState(()=>{const t=localStorage.getItem("mapMarkers");return t?JSON.parse(t):[]});return u.useEffect(()=>{localStorage.setItem("mapMarkers",JSON.stringify(o))},[o]),{markers:o,addMarker:t=>{s(c=>[...c,{...t,id:Date.now(),timestamp:new Date().toISOString()}])},removeMarker:t=>{s(c=>c.filter(p=>p.id!==t))},updateMarker:(t,c)=>{s(p=>p.map(d=>d.id===t?{...d,...c}:d))}}},Ge=()=>{const[o,s]=u.useState(()=>{const t=localStorage.getItem("mapPaths");return t?JSON.parse(t):[]});return u.useEffect(()=>{localStorage.setItem("mapPaths",JSON.stringify(o))},[o]),{paths:o,addPath:t=>{s(c=>[...c,{...t,id:Date.now(),timestamp:new Date().toISOString()}])},removePath:t=>{s(c=>c.filter(p=>p.id!==t))},updatePath:(t,c)=>{s(p=>p.map(d=>d.id===t?{...d,...c}:d))}}},qe=(o="geojson")=>{const s=JSON.parse(localStorage.getItem("mapMarkers")||"[]"),h=JSON.parse(localStorage.getItem("mapPaths")||"[]");let a,r,t;switch(o){case"geojson":const i={type:"FeatureCollection",features:[...s.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.position[1],l.position[0]]},properties:l.data||{}})),...h.map(l=>({type:"Feature",geometry:{type:"LineString",coordinates:l.coordinates.map(f=>[f[1],f[0]])},properties:{name:l.name,description:l.description,type:l.type,timestamp:l.timestamp}}))]};a=JSON.stringify(i,null,2),r="application/geo+json",t="geojson";break;case"kml":const x=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>`,v=`  </Document>
</kml>`,j=s.map(l=>{var f,M;return`
    <Placemark>
      <name>${((f=l.data)==null?void 0:f.name)||"Unnamed Marker"}</name>
      <description>${((M=l.data)==null?void 0:M.description)||""}</description>
      <Point>
        <coordinates>${l.position[1]},${l.position[0]},0</coordinates>
      </Point>
    </Placemark>`}).join(""),y=h.map(l=>`
    <Placemark>
      <name>${l.name||"Unnamed Path"}</name>
      <description>${l.description||""}</description>
      <LineString>
        <coordinates>
          ${l.coordinates.map(f=>`${f[1]},${f[0]},0`).join(" ")}
        </coordinates>
      </LineString>
    </Placemark>`).join("");a=x+j+y+v,r="application/vnd.google-earth.kml+xml",t="kml";break;case"csv":const k=`Type,Name,Description,Latitude,Longitude,Timestamp
`,D=s.map(l=>{var f,M;return`Point,"${((f=l.data)==null?void 0:f.name)||""}","${((M=l.data)==null?void 0:M.description)||""}",${l.position[0]},${l.position[1]},"${l.timestamp}"`}).join(`
`),I=h.map(l=>`Line,"${l.name||""}","${l.description||""}",${l.coordinates[0][0]},${l.coordinates[0][1]},"${l.timestamp}"`).join(`
`);a=k+D+(s.length&&h.length?`
`:"")+I,r="text/csv",t="csv";break;default:const O={version:"1.0",exportDate:new Date().toISOString(),markers:s,paths:h};a=JSON.stringify(O,null,2),r="application/json",t="json"}const c=new Blob([a],{type:r}),p=URL.createObjectURL(c),d=`map_export_${new Date().toISOString().replace(/[:.]/g,"-")}.${t}`,g=document.createElement("a");g.href=p,g.download=d,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(p)},Ke=o=>new Promise((s,h)=>{const a=new FileReader;a.onload=r=>{try{const t=JSON.parse(r.target.result);t.version&&t.markers&&t.paths?(localStorage.setItem("mapMarkers",JSON.stringify(t.markers)),localStorage.setItem("mapPaths",JSON.stringify(t.paths)),s(t)):h(new Error("Invalid import file format"))}catch(t){h(t)}},a.onerror=r=>h(r),a.readAsText(o)});function Ze({isTracking:o,onStartTracking:s,onStopTracking:h,onAddMarker:a,onExport:r,onImportClick:t,onFilter:c}){const[p,d]=u.useState(null),g=x=>{d(x.currentTarget)},i=x=>{d(null),x&&typeof r=="function"&&r(x)};return e.jsxs(te,{sx:{position:"fixed",bottom:0,left:0,right:0,bgcolor:"background.paper",display:"flex",justifyContent:"center",padding:"8px",zIndex:1200,borderTop:"1px solid",borderColor:"divider",gap:1},children:[e.jsx(L,{onClick:o?h:s,startIcon:o?e.jsx(Te,{}):e.jsx(De,{}),variant:o?"contained":"outlined",color:o?"error":"success",size:"small",children:o?"ÿ™ŸàŸÇŸÅ":"ÿ±ÿØ€åÿßÿ®€å"}),e.jsx(L,{onClick:a,startIcon:e.jsx(Ee,{}),variant:"outlined",color:"primary",size:"small",children:"ŸÜÿ¥ÿßŸÜ⁄Øÿ±"}),e.jsx(L,{onClick:c,startIcon:e.jsx(Fe,{}),variant:"outlined",color:"secondary",size:"small",children:"ŸÅ€åŸÑÿ™ÿ±"}),e.jsx(L,{onClick:g,startIcon:e.jsx(H,{}),variant:"contained",color:"warning",size:"small",children:"ÿÆÿ±Ÿàÿ¨€å"}),e.jsxs(Ne,{anchorEl:p,open:!!p,onClose:()=>i(),children:[e.jsxs(S,{onClick:()=>i("geojson"),children:[e.jsx($,{children:e.jsx(Re,{fontSize:"small"})}),e.jsx(z,{children:"GeoJSON"})]}),e.jsxs(S,{onClick:()=>i("kml"),children:[e.jsx($,{children:e.jsx(Ae,{fontSize:"small"})}),e.jsx(z,{children:"KML"})]}),e.jsxs(S,{onClick:()=>i("csv"),children:[e.jsx($,{children:e.jsx(H,{fontSize:"small"})}),e.jsx(z,{children:"CSV"})]}),e.jsxs(S,{onClick:()=>i("json"),children:[e.jsx($,{children:e.jsx(H,{fontSize:"small"})}),e.jsx(z,{children:"JSON"})]})]}),e.jsx(L,{onClick:t,startIcon:e.jsx($e,{}),variant:"outlined",size:"small",sx:{ml:"auto"},children:"Ÿàÿ±ŸàÿØ€å"})]})}const X=_.divIcon({className:"custom-marker-icon",html:`
    <div style="
      width: 30px; 
      height: 30px; 
      background-color: #2196F3; 
      border-radius: 50%; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      color: white; 
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    ">
      üìç
    </div>
  `,iconSize:[30,30],iconAnchor:[15,15]}),Ye=({selectedItem:o,onDelete:s,onClose:h})=>{var t,c,p,d,g,i,x,v;const a=j=>!j||j.length===0?"ŸÜÿØÿßÿ±ÿØ":j.map(y=>{switch(y){case"wheelchair":return"Ÿà€åŸÑ⁄Üÿ±";case"electricVan":return"ŸàŸÜ ÿ®ÿ±ŸÇ€å";case"walking":return"Ÿæ€åÿßÿØŸá‚Äåÿ±Ÿà€å";default:return y}}).join(", "),r=j=>{if(!j||j.length<2)return 0;let y=0;for(let k=1;k<j.length;k++){const D=_.latLng(j[k-1][0],j[k-1][1]),I=_.latLng(j[k][0],j[k][1]);y+=D.distanceTo(I)}return(y/1e3).toFixed(2)};return e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 4px 15px rgba(0,0,0,0.2)",width:"90%",maxWidth:"400px",maxHeight:"80vh",overflowY:"auto",zIndex:1e3},children:[e.jsxs("h2",{style:{marginBottom:"15px",textAlign:"center",color:"#333"},children:["ÿ¨ÿ≤ÿ¶€åÿßÿ™ ",o.type==="marker"?"ŸÜÿ¥ÿßŸÜ⁄Øÿ±":"ŸÖÿ≥€åÿ±"]}),e.jsxs("div",{style:{backgroundColor:"#f4f4f4",padding:"15px",borderRadius:"8px",marginBottom:"15px"},children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ŸÜÿßŸÖ:"})," ",((t=o.item.data)==null?void 0:t.name)||o.item.name||"ÿ®ÿØŸàŸÜ ŸÜÿßŸÖ"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™:"})," ",((c=o.item.data)==null?void 0:c.description)||o.item.description||"ÿ®ÿØŸàŸÜ ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™"]})]}),o.type==="marker"&&e.jsxs("div",{style:{backgroundColor:"#e9f5e9",padding:"15px",borderRadius:"8px",marginBottom:"15px"},children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ŸÜŸàÿπ ŸÜÿ¥ÿßŸÜ⁄Øÿ±:"})," ",((p=o.item.data)==null?void 0:p.type)||"ŸÜÿßŸÖÿ¥ÿÆÿµ"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ¥€åŸàŸá‚ÄåŸáÿß€å ÿ≠ŸÖŸÑ Ÿà ŸÜŸÇŸÑ:"})," ",a((d=o.item.data)==null?void 0:d.transportModes)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ¨ŸÜÿ≥€åÿ™ ÿ™ÿ±ÿØÿØ:"}),((g=o.item.data)==null?void 0:g.gender)==="male"?"ŸÖÿ±ÿØÿßŸÜŸá":((i=o.item.data)==null?void 0:i.gender)==="female"?"ÿ≤ŸÜÿßŸÜŸá":((x=o.item.data)==null?void 0:x.gender)==="family"?"ÿÆÿßŸÜŸàÿßÿØ⁄Ø€å":"ŸÜÿßŸÖÿ¥ÿÆÿµ"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å:"}),`${o.item.position[0].toFixed(4)}, ${o.item.position[1].toFixed(4)}`]})]}),o.type==="path"&&e.jsxs("div",{style:{backgroundColor:"#e6f2ff",padding:"15px",borderRadius:"8px",marginBottom:"15px"},children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ŸÜŸàÿπ ŸÖÿ≥€åÿ±:"})," ",o.item.type||"ŸÜÿßŸÖÿ¥ÿÆÿµ"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ∑ŸàŸÑ ŸÖÿ≥€åÿ±:"})," ",r(o.item.coordinates)," ⁄©€åŸÑŸàŸÖÿ™ÿ±"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ™ÿπÿØÿßÿØ ŸÜŸÇÿßÿ∑ ŸÖÿ≥€åÿ±:"})," ",((v=o.item.coordinates)==null?void 0:v.length)||0]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ÿ™ÿßÿ±€åÿÆ ÿß€åÿ¨ÿßÿØ:"})," ",new Date(o.item.timestamp).toLocaleDateString("fa-IR")]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"15px"},children:[e.jsxs("button",{onClick:s,style:{backgroundColor:"#dc3545",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{children:"üóëÔ∏è"})," ÿ®ŸÑŸáÿå ÿ≠ÿ∞ŸÅ ÿ¥ŸàÿØ"]}),e.jsxs("button",{onClick:h,style:{backgroundColor:"#6c757d",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{children:"‚úñ"})," ÿßŸÜÿµÿ±ÿßŸÅ"]})]})]})};function Qe({onSave:o,onClose:s,pathCoordinates:h}){const[a,r]=u.useState(""),[t,c]=u.useState(""),[p,d]=u.useState(""),g=()=>{if(!a.trim()){alert("ŸÜÿßŸÖ ŸÖÿ≥€åÿ± ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ");return}const i={name:a,description:t,type:p,coordinates:h,timestamp:new Date().toISOString()};o(i),s()};return e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",zIndex:1e3,width:"90%",maxWidth:"400px"},children:[e.jsx("h2",{children:"ÿ∞ÿÆ€åÿ±Ÿá‚Äåÿ≥ÿßÿ≤€å ŸÖÿ≥€åÿ±"}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("label",{children:"ŸÜÿßŸÖ ŸÖÿ≥€åÿ±:"}),e.jsx("input",{type:"text",value:a,onChange:i=>r(i.target.value),placeholder:"ŸÜÿßŸÖ ŸÖÿ≥€åÿ± ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ",style:{width:"100%",padding:"5px"},required:!0})]}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("label",{children:"ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™:"}),e.jsx("textarea",{value:t,onChange:i=>c(i.target.value),placeholder:"ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™ ŸÖÿ≥€åÿ± ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ",style:{width:"100%",padding:"5px",minHeight:"100px"}})]}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("label",{children:"ŸÜŸàÿπ ŸÖÿ≥€åÿ±:"}),e.jsxs("select",{value:p,onChange:i=>d(i.target.value),style:{width:"100%",padding:"5px"},children:[e.jsx("option",{value:"",children:"ÿßŸÜÿ™ÿÆÿßÿ® ŸÜŸàÿπ ŸÖÿ≥€åÿ±"}),e.jsx("option",{value:"hiking",children:"Ÿæ€åÿßÿØŸá‚Äåÿ±Ÿà€å"}),e.jsx("option",{value:"driving",children:"ÿ±ÿßŸÜŸÜÿØ⁄Ø€å"}),e.jsx("option",{value:"other",children:"ÿ≥ÿß€åÿ±"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("button",{onClick:g,style:{padding:"10px",backgroundColor:"green",color:"white",border:"none",borderRadius:"5px"},children:"ÿ∞ÿÆ€åÿ±Ÿá"}),e.jsx("button",{onClick:s,style:{padding:"10px",backgroundColor:"red",color:"white",border:"none",borderRadius:"5px"},children:"ÿßŸÜÿµÿ±ÿßŸÅ"})]})]})}function Xe({onMapClick:o}){return Ue({click:s=>{o(s.latlng)}}),null}function et({position:o,zoom:s}){const h=Je();return u.useEffect(()=>{o&&h.setView(o,s)},[o,s]),null}function tt({isOpen:o,onClose:s,filterOptions:h,setFilterOptions:a}){if(!o)return null;const r=(t,c)=>{a(p=>{const d=p[t]||[],g=d.includes(c)?d.filter(i=>i!==c):[...d,c];return{...p,[t]:g}})};return e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 4px 15px rgba(0,0,0,0.2)",zIndex:1e3,width:"90%",maxWidth:"400px"},children:[e.jsx("h2",{children:"ŸÅ€åŸÑÿ™ÿ±ÿ≥ÿßÿ≤€å"}),e.jsxs("div",{children:[e.jsx("h3",{children:"ŸÜŸàÿπ ŸÜÿ¥ÿßŸÜ⁄Øÿ±"}),["checkpoint","landmark","poi","other"].map(t=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:h.markerTypes.includes(t),onChange:()=>r("markerTypes",t)}),t==="checkpoint"&&"ŸÜŸÇÿ∑Ÿá ÿ®ÿßÿ≤ÿ±ÿ≥€å",t==="landmark"&&"ŸÜÿ¥ÿßŸÜŸá",t==="poi"&&"ŸÜŸÇÿ∑Ÿá ÿØŸÑÿÆŸàÿßŸá",t==="other"&&"ÿ≥ÿß€åÿ±"]},t))]}),e.jsxs("div",{children:[e.jsx("h3",{children:"ŸÜŸàÿπ ŸÖÿ≥€åÿ±"}),["hiking","driving","other"].map(t=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:h.pathTypes.includes(t),onChange:()=>r("pathTypes",t)}),t==="hiking"&&"Ÿæ€åÿßÿØŸá‚Äåÿ±Ÿà€å",t==="driving"&&"ÿ±ÿßŸÜŸÜÿØ⁄Ø€å",t==="other"&&"ÿ≥ÿß€åÿ±"]},t))]}),e.jsx("button",{onClick:s,children:"ÿ®ÿ≥ÿ™ŸÜ"})]})}const nt=()=>{const[o,s]=u.useState([36.2972,59.6067]),[h,a]=u.useState(12),[r,t]=u.useState(null),[c,p]=u.useState(null),[d,g]=u.useState([]),[i,x]=u.useState(null),[v,j]=u.useState(null),[y,k]=u.useState(!1),[D,I]=u.useState(!1),[O,l]=u.useState(null),[f,M]=u.useState(!1),[G,oe]=u.useState("street"),E=u.useRef(null),re=(n="json")=>{qe(n)},[w,se]=u.useState({markerTypes:[],pathTypes:[],transportModes:[],gender:[]}),ae={street:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",satellite:"https://tiles.maps.eox.at/wmts/1.0.0/s2cloudless-2020_3857/default/g/{z}/{y}/{x}.jpg"},{markers:ie,addMarker:le,removeMarker:ce}=_e(),{paths:de,addPath:pe,removePath:ue}=Ge(),R=u.useRef(null),q=u.useCallback(()=>{if(x(null),!navigator.geolocation){x("ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å ÿØÿ± ÿØÿ≥ÿ™⁄ØÿßŸá ÿ¥ŸÖÿß Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ€å ŸÜŸÖ€å‚Äåÿ¥ŸàÿØ");return}const n={enableHighAccuracy:!0,timeout:3e4,maximumAge:0};navigator.geolocation.getCurrentPosition(m=>{const{latitude:C,longitude:F,accuracy:P}=m.coords,b=[C,F];t(b),p(P),s(b),a(15)},m=>{switch(m.code){case m.PERMISSION_DENIED:x("ÿØÿ≥ÿ™ÿ±ÿ≥€å ÿ®Ÿá ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å ÿ±ÿØ ÿ¥ÿØ");break;case m.POSITION_UNAVAILABLE:x("ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÖŸàŸÇÿπ€åÿ™ ÿØÿ± ÿØÿ≥ÿ™ÿ±ÿ≥ ŸÜ€åÿ≥ÿ™");break;case m.TIMEOUT:x("ÿ≤ŸÖÿßŸÜ ÿØÿ±ÿÆŸàÿßÿ≥ÿ™ ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å ÿ®Ÿá Ÿæÿß€åÿßŸÜ ÿ±ÿ≥€åÿØ");break;default:x("ÿÆÿ∑ÿß ÿØÿ± ÿØÿ±€åÿßŸÅÿ™ ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å")}s([36.2972,59.6067]),a(12)},n)},[]),he=u.useRef(d);u.useEffect(()=>{he.current=d},[d]);const xe=()=>{k(!0),g([]),x(null),E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{g(n=>(n.length===0&&(J(),x("ÿπÿØŸÖ ŸÖŸàŸÅŸÇ€åÿ™ ÿØÿ± ÿØÿ±€åÿßŸÅÿ™ ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å. ŸÑÿ∑ŸÅÿßŸã ŸÖÿ¨ÿØÿØÿßŸã ÿ™ŸÑÿßÿ¥ ⁄©ŸÜ€åÿØ.")),n))},3e4),R.current=navigator.geolocation.watchPosition(n=>{const{latitude:m,longitude:C,accuracy:F}=n.coords,P=[m,C];clearTimeout(E.current),F<=500&&(t(P),x(null),g(b=>{if(b.length===0)return[P];const N=b[b.length-1],A=1e-5;return Math.abs(N[0]-m)>A||Math.abs(N[1]-C)>A?[...b,P]:b}))},n=>{console.error("Tracking error:",n),clearTimeout(E.current);let m="ÿÆÿ∑ÿß ÿØÿ± ÿØÿ±€åÿßŸÅÿ™ ŸÖŸàŸÇÿπ€åÿ™";switch(n.code){case n.PERMISSION_DENIED:m="ÿØÿ≥ÿ™ÿ±ÿ≥€å ÿ®Ÿá ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å ÿ±ÿØ ÿ¥ÿØ";break;case n.POSITION_UNAVAILABLE:m="ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÖŸàŸÇÿπ€åÿ™ ÿØÿ± ÿØÿ≥ÿ™ÿ±ÿ≥ ŸÜ€åÿ≥ÿ™";break;case n.TIMEOUT:m="ÿ≤ŸÖÿßŸÜ ÿØÿ±ÿÆŸàÿßÿ≥ÿ™ ŸÖŸàŸÇÿπ€åÿ™ ŸÖ⁄©ÿßŸÜ€å ÿ®Ÿá Ÿæÿß€åÿßŸÜ ÿ±ÿ≥€åÿØ";break}x(m),J()},{enableHighAccuracy:!0,timeout:3e4,maximumAge:0,distanceFilter:1})},J=()=>{R.current&&(navigator.geolocation.clearWatch(R.current),R.current=null),k(!1),d.length>1?I(!0):(g([]),x("ŸÖÿ≥€åÿ± ÿ®ÿ≥€åÿßÿ± ⁄©Ÿàÿ™ÿßŸá ÿßÿ≥ÿ™. ŸÑÿ∑ŸÅÿßŸã ŸÖÿ≥ÿßŸÅÿ™ ÿ®€åÿ¥ÿ™ÿ±€å ÿ±ÿß ÿ∑€å ⁄©ŸÜ€åÿØ."))},ge=n=>{l({type:"marker",item:n})},me=n=>{l({type:"path",item:n})},je=()=>{if(O){const{type:n,item:m}=O;n==="marker"?ce(m.id):n==="path"&&ue(m.id),l(null)}},fe=n=>{pe(n),I(!1),g([])};u.useEffect(()=>{q()},[q]);const ye=n=>{j({lat:n.lat,lng:n.lng})},ke=n=>{le({position:[n.latitude,n.longitude],data:n}),j(null)},be=n=>{const m=n.target.files[0];m&&Ke(m).then(()=>{alert("ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ®ÿß ŸÖŸàŸÅŸÇ€åÿ™ Ÿàÿßÿ±ÿØ ÿ¥ÿØ!")}).catch(C=>{console.error("Import failed:",C),alert("Ÿàÿßÿ±ÿØÿ≥ÿßÿ≤€å ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÜÿßŸÖŸàŸÅŸÇ ÿ®ŸàÿØ")})},Se=ie.filter(n=>{var P,b,N;const m=w.markerTypes.length===0||w.markerTypes.includes((P=n.data)==null?void 0:P.type),C=w.transportModes.length===0||((b=n.data)==null?void 0:b.transportModes)&&n.data.transportModes.some(A=>w.transportModes.includes(A)),F=w.gender.length===0||w.gender.includes((N=n.data)==null?void 0:N.gender);return m&&C&&F}),ve=de.filter(n=>w.pathTypes.length===0||w.pathTypes.includes(n.type)),we=n=>{switch(n){case"hiking":return"#4CAF50";case"cycling":return"#2196F3";case"driving":return"#FF9800";default:return"#9C27B0"}};return e.jsxs("div",{className:"map-container",children:[e.jsx(te,{sx:{position:"absolute",top:"10px",right:"10px",backgroundColor:"#ffffffee",padding:"10px",borderRadius:"8px",zIndex:1200,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",direction:"rtl",minWidth:"180px"},children:e.jsxs(B,{fullWidth:!0,variant:"outlined",size:"small",children:[e.jsx(W,{id:"map-layer-label",style:{right:"0px",fontWeight:"bold"},children:"ŸÜŸÇÿ¥Ÿá Ÿæÿß€åŸá"}),e.jsxs(ee,{labelId:"map-layer-label",id:"map-layer-select",value:G,label:"ŸÜŸÇÿ¥Ÿá Ÿæÿß€åŸá",onChange:n=>oe(n.target.value),children:[e.jsx(S,{value:"street",children:"Street View"}),e.jsx(S,{value:"satellite",children:"Satellite View"})]})]})}),D&&e.jsx(Qe,{onSave:fe,onClose:()=>I(!1),pathCoordinates:d}),v&&e.jsx(He,{location:v,onClose:()=>j(null),onSave:ke}),f&&e.jsx(tt,{isOpen:f,onClose:()=>M(!1),filterOptions:w,setFilterOptions:se}),O&&e.jsx(Ye,{selectedItem:O,onDelete:je,onClose:()=>l(null)}),e.jsxs(ze,{center:o,zoom:h,scrollWheelZoom:!0,style:{width:"100%",height:"100%",position:"absolute",margin:0,padding:0,direction:"rtl"},children:[e.jsx(et,{position:o,zoom:h}),e.jsx(Xe,{onMapClick:ye}),e.jsx(Be,{url:ae[G],attribution:'¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),r&&c&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{center:r,radius:c,color:"blue",fillColor:"blue",fillOpacity:.1,weight:2}),e.jsx(Z,{center:r,radius:5,color:"blue",fillColor:"blue",fillOpacity:1,weight:0})]}),d.length>1&&e.jsx(Y,{positions:d,color:"blue",weight:5,opacity:y?.7:1,dashArray:y?"1, 1":null}),Se.map(n=>e.jsx(Q,{position:n.position,icon:X,eventHandlers:{click:()=>ge(n)}},n.id)),ve.map(n=>!n.coordinates||!Array.isArray(n.coordinates)||n.coordinates.length===0?(console.warn("Path has invalid coordinates:",n),null):e.jsxs(ne.Fragment,{children:[e.jsx(Y,{positions:n.coordinates,color:we(n.type),weight:5,opacity:.7}),e.jsx(Q,{position:n.coordinates[0],icon:X,eventHandlers:{click:()=>me(n)},children:e.jsx(We,{children:e.jsxs("div",{children:[e.jsx("strong",{children:n.name}),e.jsx("p",{children:n.description}),e.jsxs("p",{children:["ŸÜŸàÿπ ŸÖÿ≥€åÿ±: ",n.type]})]})})})]},n.id))]}),e.jsx(Ze,{isTracking:y,onStartTracking:xe,onStopTracking:J,onAddMarker:()=>j({lat:o[0],lng:o[1]}),onExport:re,onFilter:()=>M(!0)}),e.jsx("input",{id:"importInput",type:"file",accept:".json",onChange:be,style:{display:"none"}})]})};Ve.createRoot(document.getElementById("root")).render(e.jsx(ne.StrictMode,{children:e.jsx(nt,{})}));
